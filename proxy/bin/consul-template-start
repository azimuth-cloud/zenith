#!/usr/bin/env bash

set -e

#####
# Wrapper script that ensures required environment variables exist before
# starting consul-template
#####

# Require that an address for Consul be provided
if [ -z "$CONSUL_HTTP_ADDR" ]; then
    echo "[ERROR] CONSUL_HTTP_ADDR is required" 1>&2
    exit 1
fi

if [ -z "$PROXY_BASE_DOMAIN" ]; then
    echo "[ERROR] PROXY_BASE_DOMAIN is required" 1>&2
    exit 1
fi

exec /usr/bin/consul-template -config /etc/consul-template/config.hcl
